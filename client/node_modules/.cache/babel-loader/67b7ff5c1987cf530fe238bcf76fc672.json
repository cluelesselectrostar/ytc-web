{"ast":null,"code":"import LinkModules from '../components/Links_Module';\nimport TitleBanner from '../components/TitleBanner';\nimport PageTitle from '../components/PageTitle';\n\nconst d3 = require('react-d3-library');\n\nconst TubeMaps = require('tubemaps');\n\nfunction TubePage() {\n  var margin = {\n    top: 20,\n    right: 20,\n    bottom: 30,\n    left: 40\n  },\n      w = Math.max(760, window.innerWidth) - margin.left - margin.right,\n      h = Math.max(500, window.innerHeight) - margin.top - margin.bottom;\n  d3.json('london.json').then(function (data) {\n    data.stations.forEach(function (d) {\n      d.longitude = +d.longitude;\n      d.latitude = +d.latitude;\n    });\n    var tube = new TubeMaps.TubeMap(data);\n    var closures = [];\n    closures = closures.concat(tube.path(tube.getStationByName(\"Euston\"), tube.getStationByName(\"Victoria\")));\n    closures = closures.concat(tube.path(tube.getStationByName(\"West Ruislip\"), tube.getStationByName(\"North Acton\")));\n    closures = closures.concat(tube.path(tube.getStationByName(\"Tottenham Hale\"), tube.getStationByName(\"Finsbury Park\"))); // Find min and max long and lat\n\n    var minLat = d3.min(tube.stations, function (d) {\n      return d.latitude;\n    });\n    var minLon = d3.min(tube.stations, function (d) {\n      return d.longitude;\n    });\n    var maxLat = d3.max(tube.stations, function (d) {\n      return d.latitude;\n    });\n    var maxLon = d3.max(tube.stations, function (d) {\n      return d.longitude;\n    }); // Set up the scales\n\n    var x = d3.scale.linear().domain([minLon, maxLon]).range([0, w]);\n    var y = d3.scale.linear().domain([minLat, maxLat]).range([h, 0]); // Set up the axis\n\n    var xAxis = d3.svg.axis().scale(x).orient(\"bottom\").tickSize(-h);\n    var yAxis = d3.svg.axis().scale(y).orient(\"left\").ticks(5).tickSize(-w); // Set up what will happen when zooming\n\n    var zoom = d3.behavior.zoom().x(x).y(y).scaleExtent([1, 10]).on(\"zoom\", zoomed);\n    /*\r\n    Drawing from now on\r\n    */\n    // Setting up the canvas\n\n    var vis = d3.select(\"#map\").append(\"svg\").attr(\"width\", w + margin.left + margin.right).attr(\"height\", h + margin.top + margin.bottom).append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\"); // Make sure it is zoomable\n\n    d3.select(\"#map svg\").call(zoom); // Drawing lines between stations\n\n    var route = vis.selectAll(\"line.route\").data(tube.connections).enter().append(\"svg:line\").attr(\"class\", \"route\").attr(\"stroke\", function (d) {\n      return '#' + tube.linesById[d.line].colour;\n    }).attr(\"stroke-linecap\", 'round').attr(\"x1\", function (d) {\n      return x(d.station1.longitude);\n    }).attr(\"y1\", function (d) {\n      return y(d.station1.latitude);\n    }).attr(\"x2\", function (d) {\n      return x(d.station2.longitude);\n    }).attr(\"y2\", function (d) {\n      return y(d.station2.latitude);\n    }).style(\"opacity\", 0.3);\n    var closure = vis.selectAll(\"line.closure\").data(closures).enter().append(\"svg:line\").attr(\"class\", \"route closure\").attr(\"stroke\", function (d) {\n      return '#' + tube.linesById[d.line || d.station1.line].colour;\n    }).attr(\"stroke-linecap\", 'round').attr(\"x1\", function (d) {\n      return x(d.station1.longitude);\n    }).attr(\"y1\", function (d) {\n      return y(d.station1.latitude);\n    }).attr(\"x2\", function (d) {\n      return x(d.station2.longitude);\n    }).attr(\"y2\", function (d) {\n      return y(d.station2.latitude);\n    }); // Striped stations (see official map)\n\n    var stripe = vis.selectAll(\"line.stripe\").data(tube.connections.filter(function (d) {\n      return tube.linesById[d.line].stripe != \"NULL\";\n    })).enter().append(\"svg:line\").attr(\"class\", \"stripe\").attr(\"stroke\", function (d) {\n      return '#' + tube.linesById[d.line].stripe;\n    }).attr(\"stroke-linecap\", 'round').attr(\"x1\", function (d) {\n      return x(d.station1.longitude);\n    }).attr(\"y1\", function (d) {\n      return y(d.station1.latitude);\n    }).attr(\"x2\", function (d) {\n      return x(d.station2.longitude);\n    }).attr(\"y2\", function (d) {\n      return y(d.station2.latitude);\n    }); // Drawing all the stations\n\n    var station = vis.selectAll(\"circle.station\").data(tube.stations).enter().append(\"svg:circle\").attr(\"class\", \"station\").attr(\"id\", function (d) {\n      return 'station' + d.id;\n    }).attr(\"cx\", function (d) {\n      return x(d.longitude);\n    }).attr(\"cy\", function (d) {\n      return y(d.latitude);\n    }).attr(\"data-cx\", function (d) {\n      return d.longitude;\n    }).attr(\"data-cy\", function (d) {\n      return d.latitude;\n    }).attr(\"title\", function (d) {\n      return d.name;\n    }).style(\"stroke\", 'gray').style(\"fill\", '#ffffff').style(\"opacity\", 0.3).on('mouseover', function (d, i) {\n      d3.selectAll('#station' + d.id).transition().duration(25).attr(\"r\", 3 / zoom.scale()).style(\"stroke\", 'black').style(\"stroke-width\", 0.5 / zoom.scale()).style('opacity', 1);\n    }).on('mouseout', function (d, i) {\n      d3.selectAll('#station' + d.id).transition().attr(\"r\", 2.5 / zoom.scale()).duration(25).style(\"stroke-width\", 0.5 / zoom.scale()).style(\"stroke\", 'gray').style('opacity', 0.3);\n    }); // .on('click', selectStation);\n    // Adding axis\n\n    vis.append(\"g\").attr(\"class\", \"x axis\").attr(\"transform\", \"translate(0,\" + h + \")\").call(xAxis);\n    vis.append(\"g\").attr(\"class\", \"y axis\").call(yAxis);\n    zoomed();\n\n    function zoomed() {\n      // Reset axis\n      vis.select(\".x.axis\").call(xAxis);\n      vis.select(\".y.axis\").call(yAxis); // Rescale circles\n\n      vis.selectAll(\"circle\").attr(\"transform\", \"translate(\" + zoom.translate() + \")scale(\" + zoom.scale() + \")\").style(\"stroke-width\", 0.5 / zoom.scale()).attr(\"r\", 2.5 / zoom.scale()); // Rescale lines\n\n      vis.selectAll(\"line.route, line.stripe\").attr(\"transform\", \"translate(\" + zoom.translate() + \")scale(\" + zoom.scale() + \")\");\n      vis.selectAll(\"line.route\").attr(\"stroke-width\", 1 / zoom.scale());\n      vis.selectAll(\"line.route.closure\").attr(\"stroke-width\", 4 / zoom.scale());\n      vis.selectAll(\"line.stripe\").attr(\"stroke-width\", 0.5 / zoom.scale());\n    }\n  });\n}\n\n_c = TubePage;\nexport default TubePage;\n\nvar _c;\n\n$RefreshReg$(_c, \"TubePage\");","map":{"version":3,"sources":["C:/Users/yanni/Documents/App_Development/yanni-webpage/src/pages/Tube.js"],"names":["LinkModules","TitleBanner","PageTitle","d3","require","TubeMaps","TubePage","margin","top","right","bottom","left","w","Math","max","window","innerWidth","h","innerHeight","json","then","data","stations","forEach","d","longitude","latitude","tube","TubeMap","closures","concat","path","getStationByName","minLat","min","minLon","maxLat","maxLon","x","scale","linear","domain","range","y","xAxis","svg","axis","orient","tickSize","yAxis","ticks","zoom","behavior","scaleExtent","on","zoomed","vis","select","append","attr","call","route","selectAll","connections","enter","linesById","line","colour","station1","station2","style","closure","stripe","filter","station","id","name","i","transition","duration","translate"],"mappings":"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","sourcesContent":["import LinkModules from '../components/Links_Module';\r\nimport TitleBanner from '../components/TitleBanner';\r\nimport PageTitle from '../components/PageTitle';\r\nconst d3 = require('react-d3-library');\r\nconst TubeMaps = require('tubemaps');\r\n\r\nfunction TubePage() {\r\n\r\n    var margin = { top: 20, right: 20, bottom: 30, left: 40 },\r\n        w = Math.max(760, window.innerWidth) - margin.left - margin.right,\r\n        h = Math.max(500, window.innerHeight) - margin.top - margin.bottom;\r\n\r\n    d3.json('london.json').then(function (data) {\r\n\r\n        data.stations.forEach(function (d) {\r\n            d.longitude = +d.longitude;\r\n            d.latitude = +d.latitude;\r\n        })\r\n        var tube = new TubeMaps.TubeMap(data)\r\n        var closures = [];\r\n        closures = closures.concat(tube.path(tube.getStationByName(\"Euston\"), tube.getStationByName(\"Victoria\")));\r\n        closures = closures.concat(tube.path(tube.getStationByName(\"West Ruislip\"), tube.getStationByName(\"North Acton\")));\r\n        closures = closures.concat(tube.path(tube.getStationByName(\"Tottenham Hale\"), tube.getStationByName(\"Finsbury Park\")));\r\n\r\n        // Find min and max long and lat\r\n        var minLat = d3.min(tube.stations, function (d) { return d.latitude });\r\n        var minLon = d3.min(tube.stations, function (d) { return d.longitude });\r\n        var maxLat = d3.max(tube.stations, function (d) { return d.latitude });\r\n        var maxLon = d3.max(tube.stations, function (d) { return d.longitude });\r\n\r\n        // Set up the scales\r\n        var x = d3.scale.linear()\r\n            .domain([minLon, maxLon])\r\n            .range([0, w]);\r\n\r\n        var y = d3.scale.linear()\r\n            .domain([minLat, maxLat])\r\n            .range([h, 0]);\r\n\r\n        // Set up the axis\r\n        var xAxis = d3.svg.axis()\r\n            .scale(x)\r\n            .orient(\"bottom\")\r\n            .tickSize(-h);\r\n\r\n        var yAxis = d3.svg.axis()\r\n            .scale(y)\r\n            .orient(\"left\")\r\n            .ticks(5)\r\n            .tickSize(-w);\r\n\r\n        // Set up what will happen when zooming\r\n        var zoom = d3.behavior.zoom()\r\n            .x(x)\r\n            .y(y)\r\n            .scaleExtent([1, 10])\r\n            .on(\"zoom\", zoomed);\r\n\r\n        /*\r\n        Drawing from now on\r\n        */\r\n\r\n        // Setting up the canvas\r\n        var vis = d3.select(\"#map\").append(\"svg\")\r\n            .attr(\"width\", w + margin.left + margin.right)\r\n            .attr(\"height\", h + margin.top + margin.bottom)\r\n            .append(\"g\")\r\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\r\n\r\n        // Make sure it is zoomable\r\n        d3.select(\"#map svg\")\r\n            .call(zoom);\r\n\r\n        // Drawing lines between stations\r\n        var route = vis.selectAll(\"line.route\")\r\n            .data(tube.connections)\r\n            .enter().append(\"svg:line\")\r\n            .attr(\"class\", \"route\")\r\n            .attr(\"stroke\", function (d) { return '#' + tube.linesById[d.line].colour; })\r\n            .attr(\"stroke-linecap\", 'round')\r\n            .attr(\"x1\", function (d) { return x(d.station1.longitude); })\r\n            .attr(\"y1\", function (d) { return y(d.station1.latitude); })\r\n            .attr(\"x2\", function (d) { return x(d.station2.longitude); })\r\n            .attr(\"y2\", function (d) { return y(d.station2.latitude); })\r\n            .style(\"opacity\", 0.3)\r\n\r\n        var closure = vis.selectAll(\"line.closure\")\r\n            .data(closures)\r\n            .enter().append(\"svg:line\")\r\n            .attr(\"class\", \"route closure\")\r\n            .attr(\"stroke\", function (d) { return '#' + tube.linesById[d.line || d.station1.line].colour; })\r\n            .attr(\"stroke-linecap\", 'round')\r\n            .attr(\"x1\", function (d) { return x(d.station1.longitude); })\r\n            .attr(\"y1\", function (d) { return y(d.station1.latitude); })\r\n            .attr(\"x2\", function (d) { return x(d.station2.longitude); })\r\n            .attr(\"y2\", function (d) { return y(d.station2.latitude); })\r\n\r\n        // Striped stations (see official map)\r\n        var stripe = vis.selectAll(\"line.stripe\")\r\n            .data(tube.connections.filter(function (d) {\r\n                return tube.linesById[d.line].stripe != \"NULL\";\r\n            }))\r\n            .enter().append(\"svg:line\")\r\n            .attr(\"class\", \"stripe\")\r\n            .attr(\"stroke\", function (d) { return '#' + tube.linesById[d.line].stripe; })\r\n            .attr(\"stroke-linecap\", 'round')\r\n            .attr(\"x1\", function (d) { return x(d.station1.longitude); })\r\n            .attr(\"y1\", function (d) { return y(d.station1.latitude); })\r\n            .attr(\"x2\", function (d) { return x(d.station2.longitude); })\r\n            .attr(\"y2\", function (d) { return y(d.station2.latitude); })\r\n\r\n        // Drawing all the stations\r\n        var station = vis.selectAll(\"circle.station\")\r\n            .data(tube.stations)\r\n            .enter().append(\"svg:circle\")\r\n            .attr(\"class\", \"station\")\r\n            .attr(\"id\", function (d) { return 'station' + d.id })\r\n            .attr(\"cx\", function (d) { return x(d.longitude); })\r\n            .attr(\"cy\", function (d) { return y(d.latitude); })\r\n            .attr(\"data-cx\", function (d) { return d.longitude; })\r\n            .attr(\"data-cy\", function (d) { return d.latitude; })\r\n            .attr(\"title\", function (d) { return d.name })\r\n            .style(\"stroke\", 'gray')\r\n            .style(\"fill\", '#ffffff')\r\n            .style(\"opacity\", 0.3)\r\n            .on('mouseover', function (d, i) {\r\n                d3.selectAll('#station' + d.id)\r\n                    .transition()\r\n                    .duration(25)\r\n                    .attr(\"r\", 3 / zoom.scale())\r\n                    .style(\"stroke\", 'black')\r\n                    .style(\"stroke-width\", 0.5 / zoom.scale())\r\n                    .style('opacity', 1);\r\n            })\r\n            .on('mouseout', function (d, i) {\r\n                d3.selectAll('#station' + d.id)\r\n                    .transition()\r\n                    .attr(\"r\", 2.5 / zoom.scale())\r\n                    .duration(25)\r\n                    .style(\"stroke-width\", 0.5 / zoom.scale())\r\n                    .style(\"stroke\", 'gray')\r\n                    .style('opacity', 0.3);\r\n            })\r\n\r\n        // .on('click', selectStation);\r\n\r\n        // Adding axis\r\n        vis.append(\"g\")\r\n            .attr(\"class\", \"x axis\")\r\n            .attr(\"transform\", \"translate(0,\" + h + \")\")\r\n            .call(xAxis);\r\n\r\n        vis.append(\"g\")\r\n            .attr(\"class\", \"y axis\")\r\n            .call(yAxis);\r\n\r\n        zoomed()\r\n\r\n        function zoomed() {\r\n            // Reset axis\r\n            vis.select(\".x.axis\").call(xAxis);\r\n            vis.select(\".y.axis\").call(yAxis);\r\n\r\n            // Rescale circles\r\n            vis.selectAll(\"circle\")\r\n                .attr(\"transform\", \"translate(\" + zoom.translate() + \")scale(\" + zoom.scale() + \")\")\r\n                .style(\"stroke-width\", 0.5 / zoom.scale())\r\n                .attr(\"r\", 2.5 / zoom.scale());\r\n\r\n            // Rescale lines\r\n            vis.selectAll(\"line.route, line.stripe\")\r\n                .attr(\"transform\", \"translate(\" + zoom.translate() + \")scale(\" + zoom.scale() + \")\")\r\n\r\n            vis.selectAll(\"line.route\")\r\n                .attr(\"stroke-width\", 1 / (zoom.scale()))\r\n\r\n            vis.selectAll(\"line.route.closure\")\r\n                .attr(\"stroke-width\", 4 / (zoom.scale()))\r\n\r\n            vis.selectAll(\"line.stripe\")\r\n                .attr(\"stroke-width\", 0.5 / (zoom.scale()))\r\n\r\n        }\r\n\r\n\r\n    });\r\n}\r\n\r\nexport default TubePage;"]},"metadata":{},"sourceType":"module"}